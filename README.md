# BLUPF90 Pedigree and Data Statistics

### Author: Hamdy Abdel-Shafy  
### Date: April 2025  
### Affiliation: Department of Animal Production, Cairo University, Faculty of Agriculture

---

## üìù Description

This R script computes comprehensive summary statistics from **pedigree and data files** generated by the `renumf90` program in the **BLUPF90 family**. These files follow a special internal format for animal genetic evaluation. The script helps assess data structure, completeness, and coverage before running BLUP-based genetic models.

---

## üìÅ Input Files

The script expects **two input files**, typically generated during preprocessing with `renumf90`.

### 1. `renadd04.ped`

- Output of `renumf90`.
- Special internal format with 10 columns (in the sample file). The first three columns are required.
- Contains both **numeric IDs** (internal) and **alphanumeric IDs** (original animal identifiers).

| Column | Description                    |
|--------|--------------------------------|
| 1      | Animal ID (numeric/internal)   |
| 2      | Sire ID (numeric/internal)     |
| 3      | Dam ID (numeric/internal)      |
| 10     | Animal ID (alphanumeric/original) |

### 2. `renf90.dat`

- Data file used in BLUPF90 programs.
- Contains at least 8 columns (structure may vary depending on fixed effects used).

| Column | Description                          |
|--------|--------------------------------------|
| 1      | Trait value (`0` means missing)      |
| 5      | Animal ID (numeric/internal)         |
| 6      | Animal ID (alphanumeric/original)    |

---

## üßÆ What the Script Does

### ‚úÖ Basic Statistics

| Statistic                         | Description                                 |
|-----------------------------------|---------------------------------------------|
| Number of animals with records    | Animals with trait ‚â† 0                      |
| Number of sires with records      | Sires with at least one valid record        |
| Number of dams with records       | Dams with at least one valid record         |
| Total animals in pedigree         | Based on unique alphanumeric IDs            |
| Total number of valid records     | Number of non-zero records in data file     |

### ‚úÖ Extended Statistics

| Statistic                               | Description                                    |
|----------------------------------------|------------------------------------------------|
| Animals in both pedigree and data      | Overlapping IDs between files                  |
| Sires/dams without valid records       | Missing parental phenotypes                    |
| Records per animal                     | Minimum, maximum, and average count            |
| Proportion of coverage                 | Pedigree animals with records (%)              |

Results are printed in a **summary table** using `tibble` and optionally `knitr::kable()`.

---

## üìú Script Features

- Handles **missing phenotypes** (`trait == 0`)
- Maps **numeric to alphanumeric IDs** for clarity
- Produces **clear and clean tables**
- Easily adaptable for other BLUPF90 datasets

---

## üõ† How to Use

### 1. Prepare Files

Place the following files in your R working directory:

- `renadd04.ped`
- `renf90.dat`

Ensure these are generated via `renumf90`.

### 2. Run the Script

Run in R or RStudio using:

```r
source("blupf90_custom_stats.R")
```

Or copy-paste script blocks into the R console.

---

## üì¶ Required R Packages

- `dplyr`
- `tibble`
- `knitr` *(optional: for pretty tables)*

Install them via:

```r
install.packages(c("dplyr", "tibble", "knitr"))
```

---

## üìà Sample Output

```
| Statistic                                   | Value |
|--------------------------------------------|--------|
| Number of animals with valid records        | 3542   |
| Number of sires with valid records          | 215    |
| Number of dams with valid records           | 345    |
| Total animals in pedigree                   | 8100   |
| Total number of valid records               | 8543   |
| Animals in both pedigree and data           | 3528   |
| Sires without records                       | 110    |
| Dams without records                        | 96     |
| Min records per animal                      | 1      |
| Max records per animal                      | 12     |
| Avg records per animal                      | 2.41   |
| Proportion of pedigree animals with records | 0.437  |
| Proportion of sires with records            | 0.662  |
| Proportion of dams with records             | 0.782  |
```

---

## üìã Notes

- Assumes **Column 6 in the data file** matches **Column 10 in the pedigree**.
- If your files use different column indices, modify the script accordingly.
- Internal numeric IDs are only used for mapping; reporting uses **original alphanumeric IDs**.

---

## ü™™ License

This project is licensed under the [MIT License](LICENSE).

